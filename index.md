<style type="text/css">
        body {
        font-family: "PT Sans"; 
        font-size: 14px; 
        font-style: normal; 
        font-variant: normal; 
        font-weight: 400; 
        line-height: 20px;
        text-align: justify;
        }
</style>

Packages Required
-----------------

All packages required for the project are loaded below.

    library(caret)
    library(rattle)
    library(e1071)

Reading in the Data
-------------------

A training set CSV and a test set CSV are available. I shall use the
test set CSV as my validation set and hold it out until the very end of
the model-building. The training set CSV shall be split into a training
set and a test set. The variables are named accordingly.

    trainingCSV<-read.csv(file=url("https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"), header=TRUE)
    validation<-read.csv(file=url("https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"), header=TRUE)

Explore the structure of both datasets.

    str(trainingCSV)

    ## 'data.frame':    19622 obs. of  160 variables:
    ##  $ X                       : int  1 2 3 4 5 6 7 8 9 10 ...
    ##  $ user_name               : chr  "carlitos" "carlitos" "carlitos" "carlitos" ...
    ##  $ raw_timestamp_part_1    : int  1323084231 1323084231 1323084231 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 ...
    ##  $ raw_timestamp_part_2    : int  788290 808298 820366 120339 196328 304277 368296 440390 484323 484434 ...
    ##  $ cvtd_timestamp          : chr  "05/12/2011 11:23" "05/12/2011 11:23" "05/12/2011 11:23" "05/12/2011 11:23" ...
    ##  $ new_window              : chr  "no" "no" "no" "no" ...
    ##  $ num_window              : int  11 11 11 12 12 12 12 12 12 12 ...
    ##  $ roll_belt               : num  1.41 1.41 1.42 1.48 1.48 1.45 1.42 1.42 1.43 1.45 ...
    ##  $ pitch_belt              : num  8.07 8.07 8.07 8.05 8.07 8.06 8.09 8.13 8.16 8.17 ...
    ##  $ yaw_belt                : num  -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 ...
    ##  $ total_accel_belt        : int  3 3 3 3 3 3 3 3 3 3 ...
    ##  $ kurtosis_roll_belt      : chr  "" "" "" "" ...
    ##  $ kurtosis_picth_belt     : chr  "" "" "" "" ...
    ##  $ kurtosis_yaw_belt       : chr  "" "" "" "" ...
    ##  $ skewness_roll_belt      : chr  "" "" "" "" ...
    ##  $ skewness_roll_belt.1    : chr  "" "" "" "" ...
    ##  $ skewness_yaw_belt       : chr  "" "" "" "" ...
    ##  $ max_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ max_picth_belt          : int  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ max_yaw_belt            : chr  "" "" "" "" ...
    ##  $ min_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ min_pitch_belt          : int  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ min_yaw_belt            : chr  "" "" "" "" ...
    ##  $ amplitude_roll_belt     : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ amplitude_pitch_belt    : int  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ amplitude_yaw_belt      : chr  "" "" "" "" ...
    ##  $ var_total_accel_belt    : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ avg_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ stddev_roll_belt        : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ var_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ avg_pitch_belt          : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ stddev_pitch_belt       : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ var_pitch_belt          : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ avg_yaw_belt            : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ stddev_yaw_belt         : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ var_yaw_belt            : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ gyros_belt_x            : num  0 0.02 0 0.02 0.02 0.02 0.02 0.02 0.02 0.03 ...
    ##  $ gyros_belt_y            : num  0 0 0 0 0.02 0 0 0 0 0 ...
    ##  $ gyros_belt_z            : num  -0.02 -0.02 -0.02 -0.03 -0.02 -0.02 -0.02 -0.02 -0.02 0 ...
    ##  $ accel_belt_x            : int  -21 -22 -20 -22 -21 -21 -22 -22 -20 -21 ...
    ##  $ accel_belt_y            : int  4 4 5 3 2 4 3 4 2 4 ...
    ##  $ accel_belt_z            : int  22 22 23 21 24 21 21 21 24 22 ...
    ##  $ magnet_belt_x           : int  -3 -7 -2 -6 -6 0 -4 -2 1 -3 ...
    ##  $ magnet_belt_y           : int  599 608 600 604 600 603 599 603 602 609 ...
    ##  $ magnet_belt_z           : int  -313 -311 -305 -310 -302 -312 -311 -313 -312 -308 ...
    ##  $ roll_arm                : num  -128 -128 -128 -128 -128 -128 -128 -128 -128 -128 ...
    ##  $ pitch_arm               : num  22.5 22.5 22.5 22.1 22.1 22 21.9 21.8 21.7 21.6 ...
    ##  $ yaw_arm                 : num  -161 -161 -161 -161 -161 -161 -161 -161 -161 -161 ...
    ##  $ total_accel_arm         : int  34 34 34 34 34 34 34 34 34 34 ...
    ##  $ var_accel_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ avg_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ stddev_roll_arm         : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ var_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ avg_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ stddev_pitch_arm        : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ var_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ avg_yaw_arm             : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ stddev_yaw_arm          : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ var_yaw_arm             : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ gyros_arm_x             : num  0 0.02 0.02 0.02 0 0.02 0 0.02 0.02 0.02 ...
    ##  $ gyros_arm_y             : num  0 -0.02 -0.02 -0.03 -0.03 -0.03 -0.03 -0.02 -0.03 -0.03 ...
    ##  $ gyros_arm_z             : num  -0.02 -0.02 -0.02 0.02 0 0 0 0 -0.02 -0.02 ...
    ##  $ accel_arm_x             : int  -288 -290 -289 -289 -289 -289 -289 -289 -288 -288 ...
    ##  $ accel_arm_y             : int  109 110 110 111 111 111 111 111 109 110 ...
    ##  $ accel_arm_z             : int  -123 -125 -126 -123 -123 -122 -125 -124 -122 -124 ...
    ##  $ magnet_arm_x            : int  -368 -369 -368 -372 -374 -369 -373 -372 -369 -376 ...
    ##  $ magnet_arm_y            : int  337 337 344 344 337 342 336 338 341 334 ...
    ##  $ magnet_arm_z            : int  516 513 513 512 506 513 509 510 518 516 ...
    ##  $ kurtosis_roll_arm       : chr  "" "" "" "" ...
    ##  $ kurtosis_picth_arm      : chr  "" "" "" "" ...
    ##  $ kurtosis_yaw_arm        : chr  "" "" "" "" ...
    ##  $ skewness_roll_arm       : chr  "" "" "" "" ...
    ##  $ skewness_pitch_arm      : chr  "" "" "" "" ...
    ##  $ skewness_yaw_arm        : chr  "" "" "" "" ...
    ##  $ max_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ max_picth_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ max_yaw_arm             : int  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ min_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ min_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ min_yaw_arm             : int  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ amplitude_roll_arm      : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ amplitude_pitch_arm     : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ amplitude_yaw_arm       : int  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ roll_dumbbell           : num  13.1 13.1 12.9 13.4 13.4 ...
    ##  $ pitch_dumbbell          : num  -70.5 -70.6 -70.3 -70.4 -70.4 ...
    ##  $ yaw_dumbbell            : num  -84.9 -84.7 -85.1 -84.9 -84.9 ...
    ##  $ kurtosis_roll_dumbbell  : chr  "" "" "" "" ...
    ##  $ kurtosis_picth_dumbbell : chr  "" "" "" "" ...
    ##  $ kurtosis_yaw_dumbbell   : chr  "" "" "" "" ...
    ##  $ skewness_roll_dumbbell  : chr  "" "" "" "" ...
    ##  $ skewness_pitch_dumbbell : chr  "" "" "" "" ...
    ##  $ skewness_yaw_dumbbell   : chr  "" "" "" "" ...
    ##  $ max_roll_dumbbell       : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ max_picth_dumbbell      : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ max_yaw_dumbbell        : chr  "" "" "" "" ...
    ##  $ min_roll_dumbbell       : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ min_pitch_dumbbell      : num  NA NA NA NA NA NA NA NA NA NA ...
    ##  $ min_yaw_dumbbell        : chr  "" "" "" "" ...
    ##  $ amplitude_roll_dumbbell : num  NA NA NA NA NA NA NA NA NA NA ...
    ##   [list output truncated]

    str(validation)

    ## 'data.frame':    20 obs. of  160 variables:
    ##  $ X                       : int  1 2 3 4 5 6 7 8 9 10 ...
    ##  $ user_name               : chr  "pedro" "jeremy" "jeremy" "adelmo" ...
    ##  $ raw_timestamp_part_1    : int  1323095002 1322673067 1322673075 1322832789 1322489635 1322673149 1322673128 1322673076 1323084240 1322837822 ...
    ##  $ raw_timestamp_part_2    : int  868349 778725 342967 560311 814776 510661 766645 54671 916313 384285 ...
    ##  $ cvtd_timestamp          : chr  "05/12/2011 14:23" "30/11/2011 17:11" "30/11/2011 17:11" "02/12/2011 13:33" ...
    ##  $ new_window              : chr  "no" "no" "no" "no" ...
    ##  $ num_window              : int  74 431 439 194 235 504 485 440 323 664 ...
    ##  $ roll_belt               : num  123 1.02 0.87 125 1.35 -5.92 1.2 0.43 0.93 114 ...
    ##  $ pitch_belt              : num  27 4.87 1.82 -41.6 3.33 1.59 4.44 4.15 6.72 22.4 ...
    ##  $ yaw_belt                : num  -4.75 -88.9 -88.5 162 -88.6 -87.7 -87.3 -88.5 -93.7 -13.1 ...
    ##  $ total_accel_belt        : int  20 4 5 17 3 4 4 4 4 18 ...
    ##  $ kurtosis_roll_belt      : logi  NA NA NA NA NA NA ...
    ##  $ kurtosis_picth_belt     : logi  NA NA NA NA NA NA ...
    ##  $ kurtosis_yaw_belt       : logi  NA NA NA NA NA NA ...
    ##  $ skewness_roll_belt      : logi  NA NA NA NA NA NA ...
    ##  $ skewness_roll_belt.1    : logi  NA NA NA NA NA NA ...
    ##  $ skewness_yaw_belt       : logi  NA NA NA NA NA NA ...
    ##  $ max_roll_belt           : logi  NA NA NA NA NA NA ...
    ##  $ max_picth_belt          : logi  NA NA NA NA NA NA ...
    ##  $ max_yaw_belt            : logi  NA NA NA NA NA NA ...
    ##  $ min_roll_belt           : logi  NA NA NA NA NA NA ...
    ##  $ min_pitch_belt          : logi  NA NA NA NA NA NA ...
    ##  $ min_yaw_belt            : logi  NA NA NA NA NA NA ...
    ##  $ amplitude_roll_belt     : logi  NA NA NA NA NA NA ...
    ##  $ amplitude_pitch_belt    : logi  NA NA NA NA NA NA ...
    ##  $ amplitude_yaw_belt      : logi  NA NA NA NA NA NA ...
    ##  $ var_total_accel_belt    : logi  NA NA NA NA NA NA ...
    ##  $ avg_roll_belt           : logi  NA NA NA NA NA NA ...
    ##  $ stddev_roll_belt        : logi  NA NA NA NA NA NA ...
    ##  $ var_roll_belt           : logi  NA NA NA NA NA NA ...
    ##  $ avg_pitch_belt          : logi  NA NA NA NA NA NA ...
    ##  $ stddev_pitch_belt       : logi  NA NA NA NA NA NA ...
    ##  $ var_pitch_belt          : logi  NA NA NA NA NA NA ...
    ##  $ avg_yaw_belt            : logi  NA NA NA NA NA NA ...
    ##  $ stddev_yaw_belt         : logi  NA NA NA NA NA NA ...
    ##  $ var_yaw_belt            : logi  NA NA NA NA NA NA ...
    ##  $ gyros_belt_x            : num  -0.5 -0.06 0.05 0.11 0.03 0.1 -0.06 -0.18 0.1 0.14 ...
    ##  $ gyros_belt_y            : num  -0.02 -0.02 0.02 0.11 0.02 0.05 0 -0.02 0 0.11 ...
    ##  $ gyros_belt_z            : num  -0.46 -0.07 0.03 -0.16 0 -0.13 0 -0.03 -0.02 -0.16 ...
    ##  $ accel_belt_x            : int  -38 -13 1 46 -8 -11 -14 -10 -15 -25 ...
    ##  $ accel_belt_y            : int  69 11 -1 45 4 -16 2 -2 1 63 ...
    ##  $ accel_belt_z            : int  -179 39 49 -156 27 38 35 42 32 -158 ...
    ##  $ magnet_belt_x           : int  -13 43 29 169 33 31 50 39 -6 10 ...
    ##  $ magnet_belt_y           : int  581 636 631 608 566 638 622 635 600 601 ...
    ##  $ magnet_belt_z           : int  -382 -309 -312 -304 -418 -291 -315 -305 -302 -330 ...
    ##  $ roll_arm                : num  40.7 0 0 -109 76.1 0 0 0 -137 -82.4 ...
    ##  $ pitch_arm               : num  -27.8 0 0 55 2.76 0 0 0 11.2 -63.8 ...
    ##  $ yaw_arm                 : num  178 0 0 -142 102 0 0 0 -167 -75.3 ...
    ##  $ total_accel_arm         : int  10 38 44 25 29 14 15 22 34 32 ...
    ##  $ var_accel_arm           : logi  NA NA NA NA NA NA ...
    ##  $ avg_roll_arm            : logi  NA NA NA NA NA NA ...
    ##  $ stddev_roll_arm         : logi  NA NA NA NA NA NA ...
    ##  $ var_roll_arm            : logi  NA NA NA NA NA NA ...
    ##  $ avg_pitch_arm           : logi  NA NA NA NA NA NA ...
    ##  $ stddev_pitch_arm        : logi  NA NA NA NA NA NA ...
    ##  $ var_pitch_arm           : logi  NA NA NA NA NA NA ...
    ##  $ avg_yaw_arm             : logi  NA NA NA NA NA NA ...
    ##  $ stddev_yaw_arm          : logi  NA NA NA NA NA NA ...
    ##  $ var_yaw_arm             : logi  NA NA NA NA NA NA ...
    ##  $ gyros_arm_x             : num  -1.65 -1.17 2.1 0.22 -1.96 0.02 2.36 -3.71 0.03 0.26 ...
    ##  $ gyros_arm_y             : num  0.48 0.85 -1.36 -0.51 0.79 0.05 -1.01 1.85 -0.02 -0.5 ...
    ##  $ gyros_arm_z             : num  -0.18 -0.43 1.13 0.92 -0.54 -0.07 0.89 -0.69 -0.02 0.79 ...
    ##  $ accel_arm_x             : int  16 -290 -341 -238 -197 -26 99 -98 -287 -301 ...
    ##  $ accel_arm_y             : int  38 215 245 -57 200 130 79 175 111 -42 ...
    ##  $ accel_arm_z             : int  93 -90 -87 6 -30 -19 -67 -78 -122 -80 ...
    ##  $ magnet_arm_x            : int  -326 -325 -264 -173 -170 396 702 535 -367 -420 ...
    ##  $ magnet_arm_y            : int  385 447 474 257 275 176 15 215 335 294 ...
    ##  $ magnet_arm_z            : int  481 434 413 633 617 516 217 385 520 493 ...
    ##  $ kurtosis_roll_arm       : logi  NA NA NA NA NA NA ...
    ##  $ kurtosis_picth_arm      : logi  NA NA NA NA NA NA ...
    ##  $ kurtosis_yaw_arm        : logi  NA NA NA NA NA NA ...
    ##  $ skewness_roll_arm       : logi  NA NA NA NA NA NA ...
    ##  $ skewness_pitch_arm      : logi  NA NA NA NA NA NA ...
    ##  $ skewness_yaw_arm        : logi  NA NA NA NA NA NA ...
    ##  $ max_roll_arm            : logi  NA NA NA NA NA NA ...
    ##  $ max_picth_arm           : logi  NA NA NA NA NA NA ...
    ##  $ max_yaw_arm             : logi  NA NA NA NA NA NA ...
    ##  $ min_roll_arm            : logi  NA NA NA NA NA NA ...
    ##  $ min_pitch_arm           : logi  NA NA NA NA NA NA ...
    ##  $ min_yaw_arm             : logi  NA NA NA NA NA NA ...
    ##  $ amplitude_roll_arm      : logi  NA NA NA NA NA NA ...
    ##  $ amplitude_pitch_arm     : logi  NA NA NA NA NA NA ...
    ##  $ amplitude_yaw_arm       : logi  NA NA NA NA NA NA ...
    ##  $ roll_dumbbell           : num  -17.7 54.5 57.1 43.1 -101.4 ...
    ##  $ pitch_dumbbell          : num  25 -53.7 -51.4 -30 -53.4 ...
    ##  $ yaw_dumbbell            : num  126.2 -75.5 -75.2 -103.3 -14.2 ...
    ##  $ kurtosis_roll_dumbbell  : logi  NA NA NA NA NA NA ...
    ##  $ kurtosis_picth_dumbbell : logi  NA NA NA NA NA NA ...
    ##  $ kurtosis_yaw_dumbbell   : logi  NA NA NA NA NA NA ...
    ##  $ skewness_roll_dumbbell  : logi  NA NA NA NA NA NA ...
    ##  $ skewness_pitch_dumbbell : logi  NA NA NA NA NA NA ...
    ##  $ skewness_yaw_dumbbell   : logi  NA NA NA NA NA NA ...
    ##  $ max_roll_dumbbell       : logi  NA NA NA NA NA NA ...
    ##  $ max_picth_dumbbell      : logi  NA NA NA NA NA NA ...
    ##  $ max_yaw_dumbbell        : logi  NA NA NA NA NA NA ...
    ##  $ min_roll_dumbbell       : logi  NA NA NA NA NA NA ...
    ##  $ min_pitch_dumbbell      : logi  NA NA NA NA NA NA ...
    ##  $ min_yaw_dumbbell        : logi  NA NA NA NA NA NA ...
    ##  $ amplitude_roll_dumbbell : logi  NA NA NA NA NA NA ...
    ##   [list output truncated]

Data Wrangling
--------------

The output from str() above shows that there are three categories of
columns in the training set which are unnecessary variables and need to
be removed before fitting a model.

-   Firstly, there are some columns containing almost exclusively NA
    values.
-   Secondly, the first 7 columns contain metadata which has no use for
    prediction.
-   Thirdly, some columns may be vectors with a variance of almost zero.

The data wrangling procedure to remove all such columns is done below.

    # Remove columns which have at least 90 % missing values
    trainingCSV<-trainingCSV[, colMeans(is.na(trainingCSV))<0.9]

    # Remove the first 7 columns, as they contain unnecessary metadata
    trainingCSV<-trainingCSV[, -c(1:7)]

    # Remove variables with a near-zero variance
    nzv<-nearZeroVar(x=trainingCSV)
    trainingCSV<-trainingCSV[, -nzv]

Let us see how many columns we’re left with after wrangling.

    dim(trainingCSV)

    ## [1] 19622    53

Wrangling has taken us from 160 variables to 53 variables.

Create Data Partitions
----------------------

First, I split the training set CSV into a training set and a test set.
The “classe” variable is the outcome variable.

    inTraining<-createDataPartition(y=trainingCSV$classe, p=0.75, list=FALSE)
    training<-trainingCSV[inTraining, ]
    test<-trainingCSV[-inTraining, ]

Secondly, I set up control for 5-fold cross-validation.

    control<-trainControl(method="cv", number=5)

Decision Tree
-------------

The first model I will build is the decision tree. The model is trained
on the training set below.

    treeModel<-train(classe~., data=training, method="rpart", trControl=control)

The summary of the fitted model is visualized by a fancy plot.

    fancyRpartPlot(model=treeModel$finalModel)

![](report_files/figure-markdown_strict/unnamed-chunk-12-1.png)

The cross-validation accuracy plot of the model is shown below.

    plot(treeModel)

![](report_files/figure-markdown_strict/unnamed-chunk-13-1.png)

I now use the fitted model to make predictions on the test set and
evaluate the accuracy of the predictions.

    predictTree<-predict(object=treeModel, newdata=test)
    confMatTree<-confusionMatrix(data=predictTree, reference=factor(test$classe))

    confMatTree

    ## Confusion Matrix and Statistics
    ## 
    ##           Reference
    ## Prediction    A    B    C    D    E
    ##          A 1266  395  398  370  121
    ##          B   15  320   27  148  128
    ##          C  108  234  430  286  252
    ##          D    0    0    0    0    0
    ##          E    6    0    0    0  400
    ## 
    ## Overall Statistics
    ##                                           
    ##                Accuracy : 0.4927          
    ##                  95% CI : (0.4786, 0.5068)
    ##     No Information Rate : 0.2845          
    ##     P-Value [Acc > NIR] : < 2.2e-16       
    ##                                           
    ##                   Kappa : 0.3369          
    ##                                           
    ##  Mcnemar's Test P-Value : NA              
    ## 
    ## Statistics by Class:
    ## 
    ##                      Class: A Class: B Class: C Class: D Class: E
    ## Sensitivity            0.9075  0.33720  0.50292   0.0000  0.44395
    ## Specificity            0.6341  0.91960  0.78266   1.0000  0.99850
    ## Pos Pred Value         0.4965  0.50157  0.32824      NaN  0.98522
    ## Neg Pred Value         0.9452  0.85256  0.88175   0.8361  0.88862
    ## Prevalence             0.2845  0.19352  0.17435   0.1639  0.18373
    ## Detection Rate         0.2582  0.06525  0.08768   0.0000  0.08157
    ## Detection Prevalence   0.5200  0.13010  0.26713   0.0000  0.08279
    ## Balanced Accuracy      0.7708  0.62840  0.64279   0.5000  0.72123

I obtain an accuracy of 48.04 % but want more. I hence fit a random
forest model next.

Random Forest
-------------

The second model I will build is the decision tree. The model is trained
on the training set below.

    forestModel<-train(classe~., data=training, method="rf", trControl=control)

The cross-validation accuracy plot of the model is shown below.

    plot(forestModel)

![](report_files/figure-markdown_strict/unnamed-chunk-16-1.png)

I now use the fitted model to make predictions on the test set and
evaluate the accuracy of the predictions.

    predictForest<-predict(object=forestModel, newdata=test)
    confMatForest<-confusionMatrix(data=predictForest, reference=factor(test$classe))

    confMatForest

    ## Confusion Matrix and Statistics
    ## 
    ##           Reference
    ## Prediction    A    B    C    D    E
    ##          A 1394    4    0    0    0
    ##          B    0  943    3    0    0
    ##          C    0    2  850    7    3
    ##          D    0    0    2  795    3
    ##          E    1    0    0    2  895
    ## 
    ## Overall Statistics
    ##                                          
    ##                Accuracy : 0.9945         
    ##                  95% CI : (0.992, 0.9964)
    ##     No Information Rate : 0.2845         
    ##     P-Value [Acc > NIR] : < 2.2e-16      
    ##                                          
    ##                   Kappa : 0.993          
    ##                                          
    ##  Mcnemar's Test P-Value : NA             
    ## 
    ## Statistics by Class:
    ## 
    ##                      Class: A Class: B Class: C Class: D Class: E
    ## Sensitivity            0.9993   0.9937   0.9942   0.9888   0.9933
    ## Specificity            0.9989   0.9992   0.9970   0.9988   0.9993
    ## Pos Pred Value         0.9971   0.9968   0.9861   0.9938   0.9967
    ## Neg Pred Value         0.9997   0.9985   0.9988   0.9978   0.9985
    ## Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837
    ## Detection Rate         0.2843   0.1923   0.1733   0.1621   0.1825
    ## Detection Prevalence   0.2851   0.1929   0.1758   0.1631   0.1831
    ## Balanced Accuracy      0.9991   0.9965   0.9956   0.9938   0.9963

I obtain an accuracy of 99.55 %, which is perfectly satisfactory. The
out-of-sample error is hence 0.45 %.

Predictions on the Validation Set
---------------------------------

I’ve selected the random forest model as the best model to make
predictions on the validation set, which I’ve been holding out all this
while. These predictions are made below.

    predictValidation<-predict(object=forestModel, newdata=validation)

    predictValidation

    ##  [1] B A B A A E D B A A B C B A E E A B B B
    ## Levels: A B C D E
